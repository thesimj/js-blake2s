"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 * Copyright (c) 2017, Bubelich Mykola
 * https://www.bubelich.com
 *
 * (｡◕‿‿◕｡)
 *
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * Neither the name of the copyright holder nor the names of its contributors
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * BLAKE2-S Initialization Vector
 *
 * @type {[number]}
 * @private
 */
var _BLAKE2S_IV = [0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19];

/**
 * BLAKE2-S Message word schedule permutations for each round
 *
 * @type {[number]}
 * @private
 */
var _BLAKE2S_SIGMA = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 10, 4, 8, 9, 15, 13, 6, 1, 12, 0, 2, 11, 7, 5, 3, 11, 8, 12, 0, 5, 2, 15, 13, 10, 14, 3, 6, 7, 1, 9, 4, 7, 9, 3, 1, 13, 12, 11, 14, 2, 6, 5, 10, 4, 0, 15, 8, 9, 0, 5, 7, 2, 4, 10, 15, 14, 1, 11, 12, 6, 8, 3, 13, 2, 12, 6, 10, 0, 11, 8, 3, 4, 13, 7, 5, 15, 14, 1, 9, 12, 5, 1, 15, 14, 13, 4, 10, 0, 7, 6, 3, 9, 2, 8, 11, 13, 11, 7, 14, 12, 1, 3, 9, 5, 0, 15, 4, 8, 6, 2, 10, 6, 15, 14, 9, 11, 3, 0, 8, 12, 2, 13, 7, 1, 4, 10, 5, 10, 2, 8, 4, 7, 6, 1, 5, 15, 11, 9, 14, 3, 12, 13, 0];

/**
 *  BLAKE2-S Implementation class
 */

var JSBlake2s = function () {
  /**
   * Create new instance of BLAKE2-S
   * With key and personalization
   * Salt should be max 8 byte long
   * Personalization should be max 8 byte long
   *
   * @param {int} digestLength
   * @param {Uint8Array|null} key
   * @param {Uint8Array|null} salt
   * @param {Uint8Array|null} personalization
   */
  function JSBlake2s() {
    var digestLength = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 32;
    var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    var salt = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var personalization = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    _classCallCheck(this, JSBlake2s);

    var keyLength = key ? key.length : 0;

    salt = salt ? [this._get32(salt, 0), this._get32(salt, 4)] : [0, 0];

    personalization = personalization ? [this._get32(personalization, 0), this._get32(personalization, 4)] : [0, 0];

    // Init context
    this._hash = [_BLAKE2S_IV[0] ^ this._get32([digestLength, keyLength, 0x01, 0x01], 0), _BLAKE2S_IV[1], _BLAKE2S_IV[2], _BLAKE2S_IV[3], _BLAKE2S_IV[4] ^ salt[0], _BLAKE2S_IV[5] ^ salt[1], _BLAKE2S_IV[6] ^ personalization[0], _BLAKE2S_IV[7] ^ personalization[1]];

    // Buffer block with 64 elements //
    this._block = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

    this._pointer = 0;
    this._counter = 0;
    this._length = digestLength;

    // if key exists, make first round with key //
    if (keyLength > 0) {
      this.update(key);
      this._pointer = 64;
    }
  }

  /**
   * Update hash content with the given data
   *
   * @param {Uint8Array} data
   */


  _createClass(JSBlake2s, [{
    key: "update",
    value: function update(data) {
      for (var i = 0; i < data.length; i++) {
        if (this._pointer === 64) {
          this._counter += this._pointer;
          this._compress(false);
          this._pointer = 0;
        }

        // copy input array to input block //
        this._block[this._pointer++] = data[i];
      }

      return this;
    }

    /**
     * Calculates the digest of all of the data passed to be hashed
     *
     * @return {Uint8Array}
     */

  }, {
    key: "digest",
    value: function digest() {
      var result = new Uint8Array(this._length);

      this._counter += this._pointer;

      // Clear block //
      while (this._pointer < 64) {
        this._block[this._pointer++] = 0;
      }

      // Compress //
      this._compress(true);

      // Little-endian convert and store //
      for (var i = 0; i < this._length; i++) {
        result[i] = this._hash[i >> 2] >>> 8 * (i & 3);
      }

      return result;
    }

    /**
     * Cyclic right rotation
     *
     * @param {number} data
     * @param {number} shift
     * @return {number}
     * @private
     */

  }, {
    key: "_rotr",
    value: function _rotr(data, shift) {
      return data >>> shift ^ data << 32 - shift;
    }

    /**
     * Convert 4 bytes to Little-endian word
     *
     * @param {Array|Uint8Array} data
     * @param {number} index
     * @private
     */

  }, {
    key: "_get32",
    value: function _get32(data, index) {
      return data[index++] ^ data[index++] << 8 ^ data[index++] << 16 ^ data[index] << 24;
    }

    /**
     * BLAKE2-S gamma mixin function
     *
     * @param {Array} result
     * @param {number} a
     * @param {number} b
     * @param {number} c
     * @param {number} d
     * @param {number} x
     * @param {number} y
     * @private
     */

  }, {
    key: "_gamma",
    value: function _gamma(result, a, b, c, d, x, y) {
      result[a] += result[b] + x;
      result[d] = this._rotr(result[d] ^ result[a], 16);

      result[c] += result[d];
      result[b] = this._rotr(result[b] ^ result[c], 12);

      result[a] += result[b] + y;
      result[d] = this._rotr(result[d] ^ result[a], 8);

      result[c] += result[d];
      result[b] = this._rotr(result[b] ^ result[c], 7);
    }

    /**
     * BLAKE2-S compression function
     *
     * @param {Boolean} isLast
     * @private
     */

  }, {
    key: "_compress",
    value: function _compress() {
      var isLast = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var v = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; // Array with 16 elements
      var m = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; // Array with 16 elements
      var i = void 0;

      for (i = 0; i < 8; i++) {
        v[i] = this._hash[i];
        v[i + 8] = _BLAKE2S_IV[i];
      }

      v[12] ^= this._counter; // low 32 bits
      v[13] ^= this._counter / 0x100000000; // high 32 bits

      v[14] = isLast ? ~v[14] : v[14];

      // Get Little-endian words //
      for (i = 0; i < 16; i++) {
        m[i] = this._get32(this._block, i * 4);
      }

      // main iteration //
      for (i = 0; i < 10; i++) {
        this._gamma(v, 0, 4, 8, 12, m[_BLAKE2S_SIGMA[i * 16]], m[_BLAKE2S_SIGMA[i * 16 + 1]]);
        this._gamma(v, 1, 5, 9, 13, m[_BLAKE2S_SIGMA[i * 16 + 2]], m[_BLAKE2S_SIGMA[i * 16 + 3]]);
        this._gamma(v, 2, 6, 10, 14, m[_BLAKE2S_SIGMA[i * 16 + 4]], m[_BLAKE2S_SIGMA[i * 16 + 5]]);
        this._gamma(v, 3, 7, 11, 15, m[_BLAKE2S_SIGMA[i * 16 + 6]], m[_BLAKE2S_SIGMA[i * 16 + 7]]);
        this._gamma(v, 0, 5, 10, 15, m[_BLAKE2S_SIGMA[i * 16 + 8]], m[_BLAKE2S_SIGMA[i * 16 + 9]]);
        this._gamma(v, 1, 6, 11, 12, m[_BLAKE2S_SIGMA[i * 16 + 10]], m[_BLAKE2S_SIGMA[i * 16 + 11]]);
        this._gamma(v, 2, 7, 8, 13, m[_BLAKE2S_SIGMA[i * 16 + 12]], m[_BLAKE2S_SIGMA[i * 16 + 13]]);
        this._gamma(v, 3, 4, 9, 14, m[_BLAKE2S_SIGMA[i * 16 + 14]], m[_BLAKE2S_SIGMA[i * 16 + 15]]);
      }

      // update hash state //
      this._hash[0] ^= v[0] ^ v[8];
      this._hash[1] ^= v[1] ^ v[9];
      this._hash[2] ^= v[2] ^ v[10];
      this._hash[3] ^= v[3] ^ v[11];
      this._hash[4] ^= v[4] ^ v[12];
      this._hash[5] ^= v[5] ^ v[13];
      this._hash[6] ^= v[6] ^ v[14];
      this._hash[7] ^= v[7] ^ v[15];
    }
  }]);

  return JSBlake2s;
}();

// EXPORT //


if (typeof module !== "undefined" && module.exports) {
  module.exports = JSBlake2s;
}

//# sourceMappingURL=data:application/json;base64,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QUUsRUFBRixDQUF4QjtBQUNEOzs7Ozs7QUFHSDs7O0FBQ0EsSUFBSSxPQUFPLE1BQVAsS0FBa0IsV0FBbEIsSUFBaUMsT0FBTyxPQUE1QyxFQUFxRDtBQUNuRCxTQUFPLE9BQVAsR0FBaUIsU0FBakI7QUFDRCIsImZpbGUiOiJqc2JsYWtlMnMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChjKSAyMDE3LCBCdWJlbGljaCBNeWtvbGFcbiAqIGh0dHBzOi8vd3d3LmJ1YmVsaWNoLmNvbVxuICpcbiAqICjvvaHil5XigL/igL/il5XvvaEpXG4gKlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXRcbiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgbWV0OlxuICpcbiAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSxcbiAqIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuXG4gKlxuICogUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuICogdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRhdGlvblxuICogYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4gKlxuICogTmVpdGhlciB0aGUgbmFtZSBvZiB0aGUgY29weXJpZ2h0IGhvbGRlciBub3IgdGhlIG5hbWVzIG9mIGl0cyBjb250cmlidXRvcnNcbiAqIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0XG4gKiBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG4gKlxuICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBUSEUgQ09QWVJJR0hUIEhPTERFUiBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIlxuICogQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRVxuICogSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAqIEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUIE9XTkVSIE9SIENPTlRSSUJVVE9SUyBCRVxuICogTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUlxuICogQ09OU0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0ZcbiAqIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTU1xuICogSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQgT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU5cbiAqIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpXG4gKiBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRVxuICogUE9TU0lCSUxJVFkgT0YgU1VDSCBEQU1BR0UuXG4gKi9cblxuLyoqXG4gKiBCTEFLRTItUyBJbml0aWFsaXphdGlvbiBWZWN0b3JcbiAqXG4gKiBAdHlwZSB7W251bWJlcl19XG4gKiBAcHJpdmF0ZVxuICovXG5jb25zdCBfQkxBS0UyU19JViA9IFtcbiAgMHg2QTA5RTY2NywgMHhCQjY3QUU4NSwgMHgzQzZFRjM3MiwgMHhBNTRGRjUzQSxcbiAgMHg1MTBFNTI3RiwgMHg5QjA1Njg4QywgMHgxRjgzRDlBQiwgMHg1QkUwQ0QxOVxuXTtcblxuLyoqXG4gKiBCTEFLRTItUyBNZXNzYWdlIHdvcmQgc2NoZWR1bGUgcGVybXV0YXRpb25zIGZvciBlYWNoIHJvdW5kXG4gKlxuICogQHR5cGUge1tudW1iZXJdfVxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgX0JMQUtFMlNfU0lHTUEgPSBbXG4gIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsXG4gIDE0LCAxMCwgNCwgOCwgOSwgMTUsIDEzLCA2LCAxLCAxMiwgMCwgMiwgMTEsIDcsIDUsIDMsXG4gIDExLCA4LCAxMiwgMCwgNSwgMiwgMTUsIDEzLCAxMCwgMTQsIDMsIDYsIDcsIDEsIDksIDQsXG4gIDcsIDksIDMsIDEsIDEzLCAxMiwgMTEsIDE0LCAyLCA2LCA1LCAxMCwgNCwgMCwgMTUsIDgsXG4gIDksIDAsIDUsIDcsIDIsIDQsIDEwLCAxNSwgMTQsIDEsIDExLCAxMiwgNiwgOCwgMywgMTMsXG4gIDIsIDEyLCA2LCAxMCwgMCwgMTEsIDgsIDMsIDQsIDEzLCA3LCA1LCAxNSwgMTQsIDEsIDksXG4gIDEyLCA1LCAxLCAxNSwgMTQsIDEzLCA0LCAxMCwgMCwgNywgNiwgMywgOSwgMiwgOCwgMTEsXG4gIDEzLCAxMSwgNywgMTQsIDEyLCAxLCAzLCA5LCA1LCAwLCAxNSwgNCwgOCwgNiwgMiwgMTAsXG4gIDYsIDE1LCAxNCwgOSwgMTEsIDMsIDAsIDgsIDEyLCAyLCAxMywgNywgMSwgNCwgMTAsIDUsXG4gIDEwLCAyLCA4LCA0LCA3LCA2LCAxLCA1LCAxNSwgMTEsIDksIDE0LCAzLCAxMiwgMTMsIDBcbl07XG5cbi8qKlxuICogIEJMQUtFMi1TIEltcGxlbWVudGF0aW9uIGNsYXNzXG4gKi9cbmNsYXNzIEpTQmxha2UycyB7XG4gIC8qKlxuICAgKiBDcmVhdGUgbmV3IGluc3RhbmNlIG9mIEJMQUtFMi1TXG4gICAqIFdpdGgga2V5IGFuZCBwZXJzb25hbGl6YXRpb25cbiAgICogU2FsdCBzaG91bGQgYmUgbWF4IDggYnl0ZSBsb25nXG4gICAqIFBlcnNvbmFsaXphdGlvbiBzaG91bGQgYmUgbWF4IDggYnl0ZSBsb25nXG4gICAqXG4gICAqIEBwYXJhbSB7aW50fSBkaWdlc3RMZW5ndGhcbiAgICogQHBhcmFtIHtVaW50OEFycmF5fG51bGx9IGtleVxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl8bnVsbH0gc2FsdFxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl8bnVsbH0gcGVyc29uYWxpemF0aW9uXG4gICAqL1xuICBjb25zdHJ1Y3RvcihkaWdlc3RMZW5ndGggPSAzMiwga2V5ID0gbnVsbCwgc2FsdCA9IG51bGwsIHBlcnNvbmFsaXphdGlvbiA9IG51bGwpIHtcblxuICAgIGNvbnN0IGtleUxlbmd0aCA9IGtleSA/IGtleS5sZW5ndGggOiAwO1xuXG4gICAgc2FsdCA9IHNhbHRcbiAgICAgID8gW3RoaXMuX2dldDMyKHNhbHQsIDApLCB0aGlzLl9nZXQzMihzYWx0LCA0KV1cbiAgICAgIDogWzAsIDBdO1xuXG4gICAgcGVyc29uYWxpemF0aW9uID0gcGVyc29uYWxpemF0aW9uXG4gICAgICA/IFt0aGlzLl9nZXQzMihwZXJzb25hbGl6YXRpb24sIDApLCB0aGlzLl9nZXQzMihwZXJzb25hbGl6YXRpb24sIDQpXVxuICAgICAgOiBbMCwgMF07XG5cbiAgICAvLyBJbml0IGNvbnRleHRcbiAgICB0aGlzLl9oYXNoID0gW1xuICAgICAgX0JMQUtFMlNfSVZbMF0gXiB0aGlzLl9nZXQzMihbZGlnZXN0TGVuZ3RoLCBrZXlMZW5ndGgsIDB4MDEsIDB4MDFdLCAwKSxcbiAgICAgIF9CTEFLRTJTX0lWWzFdLFxuICAgICAgX0JMQUtFMlNfSVZbMl0sXG4gICAgICBfQkxBS0UyU19JVlszXSxcbiAgICAgIF9CTEFLRTJTX0lWWzRdIF4gc2FsdFswXSxcbiAgICAgIF9CTEFLRTJTX0lWWzVdIF4gc2FsdFsxXSxcbiAgICAgIF9CTEFLRTJTX0lWWzZdIF4gcGVyc29uYWxpemF0aW9uWzBdLFxuICAgICAgX0JMQUtFMlNfSVZbN10gXiBwZXJzb25hbGl6YXRpb25bMV0sXG4gICAgXTtcblxuICAgIC8vIEJ1ZmZlciBibG9jayB3aXRoIDY0IGVsZW1lbnRzIC8vXG4gICAgdGhpcy5fYmxvY2sgPSBbXG4gICAgICAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLFxuICAgICAgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMFxuICAgIF07XG5cbiAgICB0aGlzLl9wb2ludGVyID0gMDtcbiAgICB0aGlzLl9jb3VudGVyID0gMDtcbiAgICB0aGlzLl9sZW5ndGggPSBkaWdlc3RMZW5ndGg7XG5cbiAgICAvLyBpZiBrZXkgZXhpc3RzLCBtYWtlIGZpcnN0IHJvdW5kIHdpdGgga2V5IC8vXG4gICAgaWYgKGtleUxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudXBkYXRlKGtleSk7XG4gICAgICB0aGlzLl9wb2ludGVyID0gNjQ7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBoYXNoIGNvbnRlbnQgd2l0aCB0aGUgZ2l2ZW4gZGF0YVxuICAgKlxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IGRhdGFcbiAgICovXG4gIHVwZGF0ZShkYXRhKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5fcG9pbnRlciA9PT0gNjQpIHtcbiAgICAgICAgdGhpcy5fY291bnRlciArPSB0aGlzLl9wb2ludGVyO1xuICAgICAgICB0aGlzLl9jb21wcmVzcyhmYWxzZSk7XG4gICAgICAgIHRoaXMuX3BvaW50ZXIgPSAwO1xuICAgICAgfVxuXG4gICAgICAvLyBjb3B5IGlucHV0IGFycmF5IHRvIGlucHV0IGJsb2NrIC8vXG4gICAgICB0aGlzLl9ibG9ja1t0aGlzLl9wb2ludGVyKytdID0gZGF0YVtpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZXMgdGhlIGRpZ2VzdCBvZiBhbGwgb2YgdGhlIGRhdGEgcGFzc2VkIHRvIGJlIGhhc2hlZFxuICAgKlxuICAgKiBAcmV0dXJuIHtVaW50OEFycmF5fVxuICAgKi9cbiAgZGlnZXN0KCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHRoaXMuX2xlbmd0aCk7XG5cbiAgICB0aGlzLl9jb3VudGVyICs9IHRoaXMuX3BvaW50ZXI7XG5cbiAgICAvLyBDbGVhciBibG9jayAvL1xuICAgIHdoaWxlICh0aGlzLl9wb2ludGVyIDwgNjQpIHtcbiAgICAgIHRoaXMuX2Jsb2NrW3RoaXMuX3BvaW50ZXIrK10gPSAwO1xuICAgIH1cblxuICAgIC8vIENvbXByZXNzIC8vXG4gICAgdGhpcy5fY29tcHJlc3ModHJ1ZSk7XG5cbiAgICAvLyBMaXR0bGUtZW5kaWFuIGNvbnZlcnQgYW5kIHN0b3JlIC8vXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9sZW5ndGg7IGkrKykge1xuICAgICAgcmVzdWx0W2ldID0gKHRoaXMuX2hhc2hbaSA+PiAyXSkgPj4+ICg4ICogKGkgJiAzKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDeWNsaWMgcmlnaHQgcm90YXRpb25cbiAgICpcbiAgICogQHBhcmFtIHtudW1iZXJ9IGRhdGFcbiAgICogQHBhcmFtIHtudW1iZXJ9IHNoaWZ0XG4gICAqIEByZXR1cm4ge251bWJlcn1cbiAgICogQHByaXZhdGVcbiAgICovXG4gIF9yb3RyKGRhdGEsIHNoaWZ0KSB7XG4gICAgcmV0dXJuIChkYXRhID4+PiBzaGlmdCkgXiAoZGF0YSA8PCAoMzIgLSBzaGlmdCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgNCBieXRlcyB0byBMaXR0bGUtZW5kaWFuIHdvcmRcbiAgICpcbiAgICogQHBhcmFtIHtBcnJheXxVaW50OEFycmF5fSBkYXRhXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgX2dldDMyKGRhdGEsIGluZGV4KSB7XG4gICAgcmV0dXJuIGRhdGFbaW5kZXgrK10gXiAoZGF0YVtpbmRleCsrXSA8PCA4KSBeIChkYXRhW2luZGV4KytdIDw8IDE2KSBeIChkYXRhW2luZGV4XSA8PCAyNCk7XG4gIH1cblxuICAvKipcbiAgICogQkxBS0UyLVMgZ2FtbWEgbWl4aW4gZnVuY3Rpb25cbiAgICpcbiAgICogQHBhcmFtIHtBcnJheX0gcmVzdWx0XG4gICAqIEBwYXJhbSB7bnVtYmVyfSBhXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBiXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBkXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB4XG4gICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfZ2FtbWEocmVzdWx0LCBhLCBiLCBjLCBkLCB4LCB5KSB7XG4gICAgcmVzdWx0W2FdICs9IHJlc3VsdFtiXSArIHg7XG4gICAgcmVzdWx0W2RdID0gdGhpcy5fcm90cihyZXN1bHRbZF0gXiByZXN1bHRbYV0sIDE2KTtcblxuICAgIHJlc3VsdFtjXSArPSByZXN1bHRbZF07XG4gICAgcmVzdWx0W2JdID0gdGhpcy5fcm90cihyZXN1bHRbYl0gXiByZXN1bHRbY10sIDEyKTtcblxuICAgIHJlc3VsdFthXSArPSByZXN1bHRbYl0gKyB5O1xuICAgIHJlc3VsdFtkXSA9IHRoaXMuX3JvdHIocmVzdWx0W2RdIF4gcmVzdWx0W2FdLCA4KTtcblxuICAgIHJlc3VsdFtjXSArPSByZXN1bHRbZF07XG4gICAgcmVzdWx0W2JdID0gdGhpcy5fcm90cihyZXN1bHRbYl0gXiByZXN1bHRbY10sIDcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJMQUtFMi1TIGNvbXByZXNzaW9uIGZ1bmN0aW9uXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNMYXN0XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfY29tcHJlc3MoaXNMYXN0ID0gZmFsc2UpIHtcbiAgICBjb25zdCB2ID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOyAvLyBBcnJheSB3aXRoIDE2IGVsZW1lbnRzXG4gICAgY29uc3QgbSA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsgLy8gQXJyYXkgd2l0aCAxNiBlbGVtZW50c1xuICAgIGxldCBpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgdltpXSA9IHRoaXMuX2hhc2hbaV07XG4gICAgICB2W2kgKyA4XSA9IF9CTEFLRTJTX0lWW2ldO1xuICAgIH1cblxuICAgIHZbMTJdIF49IHRoaXMuX2NvdW50ZXI7IC8vIGxvdyAzMiBiaXRzXG4gICAgdlsxM10gXj0gdGhpcy5fY291bnRlciAvIDB4MTAwMDAwMDAwOyAvLyBoaWdoIDMyIGJpdHNcblxuICAgIHZbMTRdID0gaXNMYXN0ID8gfnZbMTRdIDogdlsxNF07XG5cbiAgICAvLyBHZXQgTGl0dGxlLWVuZGlhbiB3b3JkcyAvL1xuICAgIGZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICBtW2ldID0gdGhpcy5fZ2V0MzIodGhpcy5fYmxvY2ssIGkgKiA0KTtcbiAgICB9XG5cbiAgICAvLyBtYWluIGl0ZXJhdGlvbiAvL1xuICAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAwLCA0LCA4LCAxMiwgbVtfQkxBS0UyU19TSUdNQVtpICogMTZdXSwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxXV0pO1xuICAgICAgdGhpcy5fZ2FtbWEodiwgMSwgNSwgOSwgMTMsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMl1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDNdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAyLCA2LCAxMCwgMTQsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgNF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDVdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAzLCA3LCAxMSwgMTUsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgNl1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDddXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAwLCA1LCAxMCwgMTUsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgOF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDldXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAxLCA2LCAxMSwgMTIsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMTBdXSwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxMV1dKTtcbiAgICAgIHRoaXMuX2dhbW1hKHYsIDIsIDcsIDgsIDEzLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDEyXV0sIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMTNdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAzLCA0LCA5LCAxNCwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxNF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDE1XV0pO1xuICAgIH1cblxuICAgIC8vIHVwZGF0ZSBoYXNoIHN0YXRlIC8vXG4gICAgdGhpcy5faGFzaFswXSBePSB2WzBdIF4gdls4XTtcbiAgICB0aGlzLl9oYXNoWzFdIF49IHZbMV0gXiB2WzldO1xuICAgIHRoaXMuX2hhc2hbMl0gXj0gdlsyXSBeIHZbMTBdO1xuICAgIHRoaXMuX2hhc2hbM10gXj0gdlszXSBeIHZbMTFdO1xuICAgIHRoaXMuX2hhc2hbNF0gXj0gdls0XSBeIHZbMTJdO1xuICAgIHRoaXMuX2hhc2hbNV0gXj0gdls1XSBeIHZbMTNdO1xuICAgIHRoaXMuX2hhc2hbNl0gXj0gdls2XSBeIHZbMTRdO1xuICAgIHRoaXMuX2hhc2hbN10gXj0gdls3XSBeIHZbMTVdO1xuICB9XG59XG5cbi8vIEVYUE9SVCAvL1xuaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBKU0JsYWtlMnM7XG59XG4iXX0=