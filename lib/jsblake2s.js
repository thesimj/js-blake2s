"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 * Copyright (c) 2017, Bubelich Mykola
 * https://www.bubelich.com
 *
 * (｡◕‿‿◕｡)
 *
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * Neither the name of the copyright holder nor the names of its contributors
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * BLAKE2s Initialization Vector
 *
 * @type {[number]}
 * @private
 */
var _BLAKE2S_IV = [0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19];

/**
 * BLAKE2s Message word schedule permutations for each round
 *
 * @type {[number]}
 * @private
 */
var _BLAKE2S_SIGMA = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 10, 4, 8, 9, 15, 13, 6, 1, 12, 0, 2, 11, 7, 5, 3, 11, 8, 12, 0, 5, 2, 15, 13, 10, 14, 3, 6, 7, 1, 9, 4, 7, 9, 3, 1, 13, 12, 11, 14, 2, 6, 5, 10, 4, 0, 15, 8, 9, 0, 5, 7, 2, 4, 10, 15, 14, 1, 11, 12, 6, 8, 3, 13, 2, 12, 6, 10, 0, 11, 8, 3, 4, 13, 7, 5, 15, 14, 1, 9, 12, 5, 1, 15, 14, 13, 4, 10, 0, 7, 6, 3, 9, 2, 8, 11, 13, 11, 7, 14, 12, 1, 3, 9, 5, 0, 15, 4, 8, 6, 2, 10, 6, 15, 14, 9, 11, 3, 0, 8, 12, 2, 13, 7, 1, 4, 10, 5, 10, 2, 8, 4, 7, 6, 1, 5, 15, 11, 9, 14, 3, 12, 13, 0];

/**
 *  BLAKE2-S Implementation class
 */

var JSBlake2s = function () {
  /**
   * Create new instance of BLAKE2-S
   * With key and personalization
   * Salt should be max 8 byte long
   * Personalization should be max 8 byte long
   *
   * @param {int} digestLength
   * @param {Uint8Array|null} key
   * @param {Uint8Array|null} salt
   * @param {Uint8Array|null} personalization
   */
  function JSBlake2s() {
    var digestLength = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 32;
    var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;
    var salt = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
    var personalization = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;

    _classCallCheck(this, JSBlake2s);

    var keyLength = key ? key.length : 0;

    salt = salt ? [this._get32(salt, 0), this._get32(salt, 4)] : [0, 0];

    personalization = personalization ? [this._get32(personalization, 0), this._get32(personalization, 4)] : [0, 0];

    // Init param
    var param = [this._get32([digestLength, keyLength, 0x01, 0x01], 0), 0, 0, 0].concat(_toConsumableArray(salt), _toConsumableArray(personalization));

    // Init context
    this._hash = [_BLAKE2S_IV[0] ^ param[0], _BLAKE2S_IV[1] ^ param[1], _BLAKE2S_IV[2] ^ param[2], _BLAKE2S_IV[3] ^ param[3], _BLAKE2S_IV[4] ^ param[4], _BLAKE2S_IV[5] ^ param[5], _BLAKE2S_IV[6] ^ param[6], _BLAKE2S_IV[7] ^ param[7]];

    // Buffer block with 64 elements //
    this._block = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

    this._pointer = 0;
    this._counter = 0;
    this._length = digestLength;

    // if key exists, make first round with key //
    if (keyLength > 0) {
      this.update(key);
      this._pointer = 64;
    }
  }

  /**
   * Update hash content with the given data
   *
   * @param {Uint8Array} data
   */


  _createClass(JSBlake2s, [{
    key: "update",
    value: function update(data) {
      for (var i = 0; i < data.length; i++) {
        if (this._pointer === 64) {
          this._counter += this._pointer;
          this._compress(false);
          this._pointer = 0;
        }

        // copy input array to input block //
        this._block[this._pointer++] = data[i];
      }

      return this;
    }

    /**
     * Calculates the digest of all of the data passed to be hashed
     *
     * @return {Uint8Array}
     */

  }, {
    key: "digest",
    value: function digest() {
      var result = new Uint8Array(this._length);

      this._counter += this._pointer;

      // Clear block //
      while (this._pointer < 64) {
        this._block[this._pointer++] = 0;
      }

      // Compress //
      this._compress(true);

      // Little-endian convert and store //
      for (var i = 0; i < this._length; i++) {
        result[i] = this._hash[i >> 2] >>> 8 * (i & 3);
      }

      return result;
    }

    /**
     * Cyclic right rotation
     *
     * @param {number} data
     * @param {number} shift
     * @return {number}
     * @private
     */

  }, {
    key: "_rotr",
    value: function _rotr(data, shift) {
      return data >>> shift ^ data << 32 - shift;
    }

    /**
     * Convert 4 bytes to Little-endian word
     *
     * @param {Array|Uint8Array} data
     * @param {number} index
     * @private
     */

  }, {
    key: "_get32",
    value: function _get32(data, index) {
      return data[index] ^ data[index + 1] << 8 ^ data[index + 2] << 16 ^ data[index + 3] << 24;
    }

    /**
     * BLAKE2s gamma mixin function
     *
     * @param {Array} result
     * @param {number} a
     * @param {number} b
     * @param {number} c
     * @param {number} d
     * @param {number} x
     * @param {number} y
     * @private
     */

  }, {
    key: "_gamma",
    value: function _gamma(result, a, b, c, d, x, y) {
      result[a] += result[b] + x;
      result[d] = this._rotr(result[d] ^ result[a], 16);

      result[c] += result[d];
      result[b] = this._rotr(result[b] ^ result[c], 12);

      result[a] += result[b] + y;
      result[d] = this._rotr(result[d] ^ result[a], 8);

      result[c] += result[d];
      result[b] = this._rotr(result[b] ^ result[c], 7);
    }

    /**
     * BLAKE2s compression function
     *
     * @param {Boolean} isLast
     * @private
     */

  }, {
    key: "_compress",
    value: function _compress() {
      var isLast = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

      var v = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; // Array with 16 elements
      var m = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]; // Array with 16 elements
      var i = void 0;

      for (i = 0; i < 8; i++) {
        v[i] = this._hash[i];
        v[i + 8] = _BLAKE2S_IV[i];
      }

      v[12] ^= this._counter; // low 32 bits
      v[13] ^= this._counter / 0x100000000; // high 32 bits

      v[14] = isLast ? ~v[14] : v[14];

      // Get Little-endian words //
      for (i = 0; i < 16; i++) {
        m[i] = this._get32(this._block, i * 4);
      }

      // main iteration //
      for (i = 0; i < 10; i++) {
        this._gamma(v, 0, 4, 8, 12, m[_BLAKE2S_SIGMA[i * 16]], m[_BLAKE2S_SIGMA[i * 16 + 1]]);
        this._gamma(v, 1, 5, 9, 13, m[_BLAKE2S_SIGMA[i * 16 + 2]], m[_BLAKE2S_SIGMA[i * 16 + 3]]);
        this._gamma(v, 2, 6, 10, 14, m[_BLAKE2S_SIGMA[i * 16 + 4]], m[_BLAKE2S_SIGMA[i * 16 + 5]]);
        this._gamma(v, 3, 7, 11, 15, m[_BLAKE2S_SIGMA[i * 16 + 6]], m[_BLAKE2S_SIGMA[i * 16 + 7]]);
        this._gamma(v, 0, 5, 10, 15, m[_BLAKE2S_SIGMA[i * 16 + 8]], m[_BLAKE2S_SIGMA[i * 16 + 9]]);
        this._gamma(v, 1, 6, 11, 12, m[_BLAKE2S_SIGMA[i * 16 + 10]], m[_BLAKE2S_SIGMA[i * 16 + 11]]);
        this._gamma(v, 2, 7, 8, 13, m[_BLAKE2S_SIGMA[i * 16 + 12]], m[_BLAKE2S_SIGMA[i * 16 + 13]]);
        this._gamma(v, 3, 4, 9, 14, m[_BLAKE2S_SIGMA[i * 16 + 14]], m[_BLAKE2S_SIGMA[i * 16 + 15]]);
      }

      // update hash state //
      this._hash[0] ^= v[0] ^ v[8];
      this._hash[1] ^= v[1] ^ v[9];
      this._hash[2] ^= v[2] ^ v[10];
      this._hash[3] ^= v[3] ^ v[11];
      this._hash[4] ^= v[4] ^ v[12];
      this._hash[5] ^= v[5] ^ v[13];
      this._hash[6] ^= v[6] ^ v[14];
      this._hash[7] ^= v[7] ^ v[15];
    }
  }]);

  return JSBlake2s;
}();

// EXPORT //


if (typeof module !== "undefined" && module.exports) {
  module.exports = JSBlake2s;
}

//# sourceMappingURL=data:application/json;base64,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Q0FBWCxLQUFpQixFQUFFLENBQUYsSUFBTyxFQUFFLEVBQUYsQ0FBeEI7QUFDQSxXQUFLLEtBQUwsQ0FBVyxDQUFYLEtBQWlCLEVBQUUsQ0FBRixJQUFPLEVBQUUsRUFBRixDQUF4QjtBQUNBLFdBQUssS0FBTCxDQUFXLENBQVgsS0FBaUIsRUFBRSxDQUFGLElBQU8sRUFBRSxFQUFGLENBQXhCO0FBQ0Q7Ozs7OztBQUdIOzs7QUFDQSxJQUFJLE9BQU8sTUFBUCxLQUFrQixXQUFsQixJQUFpQyxPQUFPLE9BQTVDLEVBQXFEO0FBQ25ELFNBQU8sT0FBUCxHQUFpQixTQUFqQjtBQUNEIiwiZmlsZSI6ImpzYmxha2Uycy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcsIEJ1YmVsaWNoIE15a29sYVxuICogaHR0cHM6Ly93d3cuYnViZWxpY2guY29tXG4gKlxuICogKO+9oeKXleKAv+KAv+KXle+9oSlcbiAqXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dFxuICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4gKlxuICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlLFxuICogdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqXG4gKiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UsXG4gKiB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uXG4gKiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRpc3RyaWJ1dGlvbi5cbiAqXG4gKiBOZWl0aGVyIHRoZSBuYW1lIG9mIHRoZSBjb3B5cmlnaHQgaG9sZGVyIG5vciB0aGUgbmFtZXMgb2YgaXRzIGNvbnRyaWJ1dG9yc1xuICogbWF5IGJlIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXRcbiAqIHNwZWNpZmljIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi5cbiAqXG4gKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4gKiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFXG4gKiBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRVxuICogQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBDT1BZUklHSFQgT1dORVIgT1IgQ09OVFJJQlVUT1JTIEJFXG4gKiBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SXG4gKiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRlxuICogU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUyBPRiBVU0UsIERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTXG4gKiBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTlxuICogQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSlcbiAqIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFXG4gKiBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqL1xuXG4vKipcbiAqIEJMQUtFMnMgSW5pdGlhbGl6YXRpb24gVmVjdG9yXG4gKlxuICogQHR5cGUge1tudW1iZXJdfVxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgX0JMQUtFMlNfSVYgPSBbXG4gIDB4NkEwOUU2NjcsIDB4QkI2N0FFODUsIDB4M0M2RUYzNzIsIDB4QTU0RkY1M0EsXG4gIDB4NTEwRTUyN0YsIDB4OUIwNTY4OEMsIDB4MUY4M0Q5QUIsIDB4NUJFMENEMTlcbl07XG5cbi8qKlxuICogQkxBS0UycyBNZXNzYWdlIHdvcmQgc2NoZWR1bGUgcGVybXV0YXRpb25zIGZvciBlYWNoIHJvdW5kXG4gKlxuICogQHR5cGUge1tudW1iZXJdfVxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgX0JMQUtFMlNfU0lHTUEgPSBbXG4gIDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTIsIDEzLCAxNCwgMTUsXG4gIDE0LCAxMCwgNCwgOCwgOSwgMTUsIDEzLCA2LCAxLCAxMiwgMCwgMiwgMTEsIDcsIDUsIDMsXG4gIDExLCA4LCAxMiwgMCwgNSwgMiwgMTUsIDEzLCAxMCwgMTQsIDMsIDYsIDcsIDEsIDksIDQsXG4gIDcsIDksIDMsIDEsIDEzLCAxMiwgMTEsIDE0LCAyLCA2LCA1LCAxMCwgNCwgMCwgMTUsIDgsXG4gIDksIDAsIDUsIDcsIDIsIDQsIDEwLCAxNSwgMTQsIDEsIDExLCAxMiwgNiwgOCwgMywgMTMsXG4gIDIsIDEyLCA2LCAxMCwgMCwgMTEsIDgsIDMsIDQsIDEzLCA3LCA1LCAxNSwgMTQsIDEsIDksXG4gIDEyLCA1LCAxLCAxNSwgMTQsIDEzLCA0LCAxMCwgMCwgNywgNiwgMywgOSwgMiwgOCwgMTEsXG4gIDEzLCAxMSwgNywgMTQsIDEyLCAxLCAzLCA5LCA1LCAwLCAxNSwgNCwgOCwgNiwgMiwgMTAsXG4gIDYsIDE1LCAxNCwgOSwgMTEsIDMsIDAsIDgsIDEyLCAyLCAxMywgNywgMSwgNCwgMTAsIDUsXG4gIDEwLCAyLCA4LCA0LCA3LCA2LCAxLCA1LCAxNSwgMTEsIDksIDE0LCAzLCAxMiwgMTMsIDBcbl07XG5cbi8qKlxuICogIEJMQUtFMi1TIEltcGxlbWVudGF0aW9uIGNsYXNzXG4gKi9cbmNsYXNzIEpTQmxha2UycyB7XG4gIC8qKlxuICAgKiBDcmVhdGUgbmV3IGluc3RhbmNlIG9mIEJMQUtFMi1TXG4gICAqIFdpdGgga2V5IGFuZCBwZXJzb25hbGl6YXRpb25cbiAgICogU2FsdCBzaG91bGQgYmUgbWF4IDggYnl0ZSBsb25nXG4gICAqIFBlcnNvbmFsaXphdGlvbiBzaG91bGQgYmUgbWF4IDggYnl0ZSBsb25nXG4gICAqXG4gICAqIEBwYXJhbSB7aW50fSBkaWdlc3RMZW5ndGhcbiAgICogQHBhcmFtIHtVaW50OEFycmF5fG51bGx9IGtleVxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl8bnVsbH0gc2FsdFxuICAgKiBAcGFyYW0ge1VpbnQ4QXJyYXl8bnVsbH0gcGVyc29uYWxpemF0aW9uXG4gICAqL1xuICBjb25zdHJ1Y3RvcihkaWdlc3RMZW5ndGggPSAzMiwga2V5ID0gbnVsbCwgc2FsdCA9IG51bGwsIHBlcnNvbmFsaXphdGlvbiA9IG51bGwpIHtcblxuICAgIGNvbnN0IGtleUxlbmd0aCA9IGtleSA/IGtleS5sZW5ndGggOiAwO1xuXG4gICAgc2FsdCA9IHNhbHRcbiAgICAgID8gW3RoaXMuX2dldDMyKHNhbHQsIDApLCB0aGlzLl9nZXQzMihzYWx0LCA0KV1cbiAgICAgIDogWzAsIDBdO1xuXG4gICAgcGVyc29uYWxpemF0aW9uID0gcGVyc29uYWxpemF0aW9uXG4gICAgICA/IFt0aGlzLl9nZXQzMihwZXJzb25hbGl6YXRpb24sIDApLCB0aGlzLl9nZXQzMihwZXJzb25hbGl6YXRpb24sIDQpXVxuICAgICAgOiBbMCwgMF07XG5cbiAgICAvLyBJbml0IHBhcmFtXG4gICAgY29uc3QgcGFyYW0gPSBbXG4gICAgICB0aGlzLl9nZXQzMihbZGlnZXN0TGVuZ3RoLCBrZXlMZW5ndGgsIDB4MDEsIDB4MDFdLCAwKSxcbiAgICAgIDAsXG4gICAgICAwLFxuICAgICAgMCxcbiAgICAgIC4uLnNhbHQsXG4gICAgICAuLi5wZXJzb25hbGl6YXRpb24sXG4gICAgXTtcblxuICAgIC8vIEluaXQgY29udGV4dFxuICAgIHRoaXMuX2hhc2ggPSBbXG4gICAgICBfQkxBS0UyU19JVlswXSBeIHBhcmFtWzBdLFxuICAgICAgX0JMQUtFMlNfSVZbMV0gXiBwYXJhbVsxXSxcbiAgICAgIF9CTEFLRTJTX0lWWzJdIF4gcGFyYW1bMl0sXG4gICAgICBfQkxBS0UyU19JVlszXSBeIHBhcmFtWzNdLFxuICAgICAgX0JMQUtFMlNfSVZbNF0gXiBwYXJhbVs0XSxcbiAgICAgIF9CTEFLRTJTX0lWWzVdIF4gcGFyYW1bNV0sXG4gICAgICBfQkxBS0UyU19JVls2XSBeIHBhcmFtWzZdLFxuICAgICAgX0JMQUtFMlNfSVZbN10gXiBwYXJhbVs3XSxcbiAgICBdO1xuXG4gICAgLy8gQnVmZmVyIGJsb2NrIHdpdGggNjQgZWxlbWVudHMgLy9cbiAgICB0aGlzLl9ibG9jayA9IFtcbiAgICAgIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsXG4gICAgICAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXG4gICAgXTtcblxuICAgIHRoaXMuX3BvaW50ZXIgPSAwO1xuICAgIHRoaXMuX2NvdW50ZXIgPSAwO1xuICAgIHRoaXMuX2xlbmd0aCA9IGRpZ2VzdExlbmd0aDtcblxuICAgIC8vIGlmIGtleSBleGlzdHMsIG1ha2UgZmlyc3Qgcm91bmQgd2l0aCBrZXkgLy9cbiAgICBpZiAoa2V5TGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy51cGRhdGUoa2V5KTtcbiAgICAgIHRoaXMuX3BvaW50ZXIgPSA2NDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIGhhc2ggY29udGVudCB3aXRoIHRoZSBnaXZlbiBkYXRhXG4gICAqXG4gICAqIEBwYXJhbSB7VWludDhBcnJheX0gZGF0YVxuICAgKi9cbiAgdXBkYXRlKGRhdGEpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLl9wb2ludGVyID09PSA2NCkge1xuICAgICAgICB0aGlzLl9jb3VudGVyICs9IHRoaXMuX3BvaW50ZXI7XG4gICAgICAgIHRoaXMuX2NvbXByZXNzKGZhbHNlKTtcbiAgICAgICAgdGhpcy5fcG9pbnRlciA9IDA7XG4gICAgICB9XG5cbiAgICAgIC8vIGNvcHkgaW5wdXQgYXJyYXkgdG8gaW5wdXQgYmxvY2sgLy9cbiAgICAgIHRoaXMuX2Jsb2NrW3RoaXMuX3BvaW50ZXIrK10gPSBkYXRhW2ldO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyB0aGUgZGlnZXN0IG9mIGFsbCBvZiB0aGUgZGF0YSBwYXNzZWQgdG8gYmUgaGFzaGVkXG4gICAqXG4gICAqIEByZXR1cm4ge1VpbnQ4QXJyYXl9XG4gICAqL1xuICBkaWdlc3QoKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fbGVuZ3RoKTtcblxuICAgIHRoaXMuX2NvdW50ZXIgKz0gdGhpcy5fcG9pbnRlcjtcblxuICAgIC8vIENsZWFyIGJsb2NrIC8vXG4gICAgd2hpbGUgKHRoaXMuX3BvaW50ZXIgPCA2NCkge1xuICAgICAgdGhpcy5fYmxvY2tbdGhpcy5fcG9pbnRlcisrXSA9IDA7XG4gICAgfVxuXG4gICAgLy8gQ29tcHJlc3MgLy9cbiAgICB0aGlzLl9jb21wcmVzcyh0cnVlKTtcblxuICAgIC8vIExpdHRsZS1lbmRpYW4gY29udmVydCBhbmQgc3RvcmUgLy9cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2xlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbaV0gPSAodGhpcy5faGFzaFtpID4+IDJdKSA+Pj4gKDggKiAoaSAmIDMpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIEN5Y2xpYyByaWdodCByb3RhdGlvblxuICAgKlxuICAgKiBAcGFyYW0ge251bWJlcn0gZGF0YVxuICAgKiBAcGFyYW0ge251bWJlcn0gc2hpZnRcbiAgICogQHJldHVybiB7bnVtYmVyfVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgX3JvdHIoZGF0YSwgc2hpZnQpIHtcbiAgICByZXR1cm4gKGRhdGEgPj4+IHNoaWZ0KSBeIChkYXRhIDw8ICgzMiAtIHNoaWZ0KSk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydCA0IGJ5dGVzIHRvIExpdHRsZS1lbmRpYW4gd29yZFxuICAgKlxuICAgKiBAcGFyYW0ge0FycmF5fFVpbnQ4QXJyYXl9IGRhdGFcbiAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfZ2V0MzIoZGF0YSwgaW5kZXgpIHtcbiAgICByZXR1cm4gZGF0YVtpbmRleF0gXiAoZGF0YVtpbmRleCArIDFdIDw8IDgpIF4gKGRhdGFbaW5kZXggKyAyXSA8PCAxNikgXiAoZGF0YVtpbmRleCArIDNdIDw8IDI0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCTEFLRTJzIGdhbW1hIG1peGluIGZ1bmN0aW9uXG4gICAqXG4gICAqIEBwYXJhbSB7QXJyYXl9IHJlc3VsdFxuICAgKiBAcGFyYW0ge251bWJlcn0gYVxuICAgKiBAcGFyYW0ge251bWJlcn0gYlxuICAgKiBAcGFyYW0ge251bWJlcn0gY1xuICAgKiBAcGFyYW0ge251bWJlcn0gZFxuICAgKiBAcGFyYW0ge251bWJlcn0geFxuICAgKiBAcGFyYW0ge251bWJlcn0geVxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgX2dhbW1hKHJlc3VsdCwgYSwgYiwgYywgZCwgeCwgeSkge1xuICAgIHJlc3VsdFthXSArPSByZXN1bHRbYl0gKyB4O1xuICAgIHJlc3VsdFtkXSA9IHRoaXMuX3JvdHIocmVzdWx0W2RdIF4gcmVzdWx0W2FdLCAxNik7XG5cbiAgICByZXN1bHRbY10gKz0gcmVzdWx0W2RdO1xuICAgIHJlc3VsdFtiXSA9IHRoaXMuX3JvdHIocmVzdWx0W2JdIF4gcmVzdWx0W2NdLCAxMik7XG5cbiAgICByZXN1bHRbYV0gKz0gcmVzdWx0W2JdICsgeTtcbiAgICByZXN1bHRbZF0gPSB0aGlzLl9yb3RyKHJlc3VsdFtkXSBeIHJlc3VsdFthXSwgOCk7XG5cbiAgICByZXN1bHRbY10gKz0gcmVzdWx0W2RdO1xuICAgIHJlc3VsdFtiXSA9IHRoaXMuX3JvdHIocmVzdWx0W2JdIF4gcmVzdWx0W2NdLCA3KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCTEFLRTJzIGNvbXByZXNzaW9uIGZ1bmN0aW9uXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaXNMYXN0XG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBfY29tcHJlc3MoaXNMYXN0ID0gZmFsc2UpIHtcbiAgICBjb25zdCB2ID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDBdOyAvLyBBcnJheSB3aXRoIDE2IGVsZW1lbnRzXG4gICAgY29uc3QgbSA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwXTsgLy8gQXJyYXkgd2l0aCAxNiBlbGVtZW50c1xuICAgIGxldCBpO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgdltpXSA9IHRoaXMuX2hhc2hbaV07XG4gICAgICB2W2kgKyA4XSA9IF9CTEFLRTJTX0lWW2ldO1xuICAgIH1cblxuICAgIHZbMTJdIF49IHRoaXMuX2NvdW50ZXI7IC8vIGxvdyAzMiBiaXRzXG4gICAgdlsxM10gXj0gdGhpcy5fY291bnRlciAvIDB4MTAwMDAwMDAwOyAvLyBoaWdoIDMyIGJpdHNcblxuICAgIHZbMTRdID0gaXNMYXN0ID8gfnZbMTRdIDogdlsxNF07XG5cbiAgICAvLyBHZXQgTGl0dGxlLWVuZGlhbiB3b3JkcyAvL1xuICAgIGZvciAoaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICBtW2ldID0gdGhpcy5fZ2V0MzIodGhpcy5fYmxvY2ssIGkgKiA0KTtcbiAgICB9XG5cbiAgICAvLyBtYWluIGl0ZXJhdGlvbiAvL1xuICAgIGZvciAoaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAwLCA0LCA4LCAxMiwgbVtfQkxBS0UyU19TSUdNQVtpICogMTZdXSwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxXV0pO1xuICAgICAgdGhpcy5fZ2FtbWEodiwgMSwgNSwgOSwgMTMsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMl1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDNdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAyLCA2LCAxMCwgMTQsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgNF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDVdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAzLCA3LCAxMSwgMTUsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgNl1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDddXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAwLCA1LCAxMCwgMTUsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgOF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDldXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAxLCA2LCAxMSwgMTIsIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMTBdXSwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxMV1dKTtcbiAgICAgIHRoaXMuX2dhbW1hKHYsIDIsIDcsIDgsIDEzLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDEyXV0sIG1bX0JMQUtFMlNfU0lHTUFbaSAqIDE2ICsgMTNdXSk7XG4gICAgICB0aGlzLl9nYW1tYSh2LCAzLCA0LCA5LCAxNCwgbVtfQkxBS0UyU19TSUdNQVtpICogMTYgKyAxNF1dLCBtW19CTEFLRTJTX1NJR01BW2kgKiAxNiArIDE1XV0pO1xuICAgIH1cblxuICAgIC8vIHVwZGF0ZSBoYXNoIHN0YXRlIC8vXG4gICAgdGhpcy5faGFzaFswXSBePSB2WzBdIF4gdls4XTtcbiAgICB0aGlzLl9oYXNoWzFdIF49IHZbMV0gXiB2WzldO1xuICAgIHRoaXMuX2hhc2hbMl0gXj0gdlsyXSBeIHZbMTBdO1xuICAgIHRoaXMuX2hhc2hbM10gXj0gdlszXSBeIHZbMTFdO1xuICAgIHRoaXMuX2hhc2hbNF0gXj0gdls0XSBeIHZbMTJdO1xuICAgIHRoaXMuX2hhc2hbNV0gXj0gdls1XSBeIHZbMTNdO1xuICAgIHRoaXMuX2hhc2hbNl0gXj0gdls2XSBeIHZbMTRdO1xuICAgIHRoaXMuX2hhc2hbN10gXj0gdls3XSBeIHZbMTVdO1xuICB9XG59XG5cbi8vIEVYUE9SVCAvL1xuaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlLmV4cG9ydHMpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSBKU0JsYWtlMnM7XG59XG4iXX0=